<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>snetmon</title>
    <script type="text/javascript" src="d3.min.js"></script>
    <style type="text/css">
.tick {
  font-size: 10px;
}
.domain, .tick line {
  stroke-width: 1px;
  stroke: #aaa;
}
.scroll {
  fill: none;
  pointer-events: all;
  cursor: move;
}
    </style>
  </head>
  <body>
    <svg></svg>
    <script type="text/javascript">

// Input data

var coords = [{ x: "2014-05-15 06:00:00 -0700", y: 200},
              { x: "2014-05-15 12:00:00 -0700", y: 1000},
              { x: "2014-05-15 15:00:00 -0700", y: 500},
              { x: "2014-05-15 18:00:00 -0700", y: 1500}];
var timeParser = d3.time.format("%Y-%m-%d %H:%M:%S %Z").parse;

// Sizing info

var graphLeftSide = 40;
var graphRightSide = 60;
var minCanvasWidth = 200;
var graphHeight = 270;
var yMax = 2000;

// D3 and DOM elements

var canvas = d3.select("svg")
               .attr('height', 300);
var graph = canvas.append('g')
                  .attr('transform','translate(' + graphLeftSide + ',6)');
var xScale = d3.time.scale()
               .domain([new Date(2014, 4, 15), new Date(2014, 4, 16)]);
var yScale = d3.scale.linear()
               .domain([0, yMax])
               .range([graphHeight, 0]);
var xAxis = d3.svg.axis()
              .scale(xScale)
              .orient('bottom')
              .tickSize(10,0)
              .ticks(5);
var yAxis = d3.svg.axis()
              .scale(yScale)
              .orient('right')
              .tickSize(10,0)
              .tickFormat(d3.format('s'));
var lineGen = d3.svg.line()
                .x(function(c) { return xScale(timeParser(c.x)); })
                .y(function(c) { return yScale(c.y); })
                .interpolate('step-before');
var graphxAxis = graph.append('g')
                      .attr('transform','translate(0,' + graphHeight + ')');
var graphyAxis = graph.append('g');
var clipBox = graph.append('clipPath')
                   .attr('id', 'bbox')
                   .append('rect')
                   .attr('height', graphHeight);
var graphLine = graph.append('path')
                     .attr('stroke', 'black')
                     .attr('fill', 'none')
                     .attr('clip-path', 'url(#bbox)');

// Allow the graph to be horizontally manipulable with mouse drag or
// wheel events

function refresh() {
  // Things to do whenever the graph scrolls or zooms
  graphLine.attr('d', lineGen(coords));
  xAxis(graphxAxis);
  yAxis(graphyAxis);
}
// Add a rectangle to intercept mouse events
var scrollRect = graph.append('rect')
                      .attr('class', 'scroll')
                      .attr('height', graphHeight);
// Attach the rectangle to a D3 zoom behavior
var zoomBehavior = d3.behavior.zoom()
                     .on("zoom", refresh);
zoomBehavior(scrollRect);

// Resize everything appropriately whenever the window changes size

function resize() {
  // Things to do whenever the window size changes
  var canvasWidth = Math.max(document.body.clientWidth, minCanvasWidth);
  canvas.attr('width', canvasWidth);
  var graphWidth = canvasWidth - graphLeftSide - graphRightSide;
  xScale.range([0, graphWidth]);
  graphyAxis.attr('transform','translate(' + graphWidth + ',0)');
  clipBox.attr('width', graphWidth)
  scrollRect.attr('width', graphWidth)
  zoomBehavior.x(xScale);
  refresh();
}
window.addEventListener("resize", resize, true);

// Set initial DOM state

resize();

    </script>
  </body>
</html>
